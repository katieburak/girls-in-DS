
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Day 3 - Girls in Data Science &#8212; Girls in Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notes/day3';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Day 2 - Girls in Data Science" href="day2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Girls in Data Science - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Girls in Data Science - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Girls in Data Science Camp
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="day1.html">Day 1 - Girls in Data Science</a></li>



<li class="toctree-l1"><a class="reference internal" href="day2.html">Day 2 - Girls in Data Science</a></li>



<li class="toctree-l1 current active"><a class="current reference internal" href="#">Day 3 - Girls in Data Science</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/katieburak/girls-in-DS" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/katieburak/girls-in-DS/issues/new?title=Issue%20on%20page%20%2Fnotes/day3.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notes/day3.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Day 3 - Girls in Data Science</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Day 3 - Girls in Data Science</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#day-3-learning-objectives">Day 3 Learning Objectives</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#classification">1. Classification</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-kind-of-data-analysis-question-is-this">What kind of data analysis question is this?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-and-test-sets">1.2 Training and Test Sets</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#golden-rule-of-machine-learning-statistics">Golden Rule of Machine Learning / Statistics:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nearest-neighbours-classification">1.3 K-nearest neighbours classification</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-would-the-predicted-class-be">What would the predicted class be?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-can-go-beyond-2-predictors">We can go beyond 2 predictors!</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standardizing-data">1.4 Standardizing Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nonstandardized-data-vs-standardized-data">Nonstandardized Data vs. Standardized Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tidymodels-package-in-r">1.5 <code class="docutils literal notranslate"><span class="pre">tidymodels</span></code> package in R</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-a-recipe-to-specify-the-predictors-response-and-preprocess-the-data">1. Make a <code class="docutils literal notranslate"><span class="pre">recipe</span></code> to specify the predictors/response and preprocess the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-a-model-specification-model-spec-to-specify-the-model-and-training-algorithm">2. Build a model specification (<code class="docutils literal notranslate"><span class="pre">model_spec</span></code>) to specify the model and training algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#put-them-together-in-a-workflow-and-then-fit-it">3. Put them together in a workflow and then <code class="docutils literal notranslate"><span class="pre">fit</span></code> it</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-a-new-class-label-using-predict">4. Predict a new class label using <code class="docutils literal notranslate"><span class="pre">predict</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-measure-classifier-performance">1.6 How to measure classifier performance?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy">Accuracy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precision-and-recall">Precision and Recall</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-question">In-class Question</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-k-or-tuning-the-model">1.7 Choosing K (or, “tuning’’ the model)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation">Cross-Validation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#underfitting-overfitting">Underfitting &amp; Overfitting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Underfitting &amp; Overfitting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Underfitting &amp; Overfitting</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-performance-metrics">1.8 Compute performance metrics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-big-picture">The Big Picture</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question">Question</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#activity">Activity</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#regression">2. Regression</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nearest-neighbours-regression">2.1 K nearest neighbours regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-evaluation-and-tuning">2.2 Model Evaluation and Tuning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#is-our-model-any-good">Is our model any good?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#final-model-from-k-nn-regression">Final model from k-nn regression</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion-which-of-the-following-is-overfitting-underfitting">Discussion: Which of the following is overfitting? Underfitting?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="day-3-girls-in-data-science">
<h1>Day 3 - Girls in Data Science<a class="headerlink" href="#day-3-girls-in-data-science" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load libraries</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tidymodels</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">palmerpenguins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── <span class=" -Color -Color-Bold">Attaching core tidyverse packages</span> ─────────────────────────────────────────────────────────────────────────────── tidyverse 2.0.0 ──
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">dplyr    </span> 1.1.4     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">readr    </span> 2.1.5
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">forcats  </span> 1.0.0     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">stringr  </span> 1.5.1
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">lubridate</span> 1.9.3     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">tibble   </span> 3.2.1
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">purrr    </span> 1.0.2     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">tidyr    </span> 1.3.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── <span class=" -Color -Color-Bold">Conflicts</span> ───────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">dplyr</span>::<span class=" -Color -Color-Green">filter()</span> masks <span class=" -Color -Color-Blue">stats</span>::filter()
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">dplyr</span>::<span class=" -Color -Color-Green">lag()</span>    masks <span class=" -Color -Color-Blue">stats</span>::lag()
<span class=" -Color -Color-Cyan">ℹ</span> Use the conflicted package (<span class=" -Color -Color-Blue">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── <span class=" -Color -Color-Bold">Attaching packages</span> ───────────────────────────────────────────────────────────────────────────────────────────── tidymodels 1.2.0 ──
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">broom       </span> 1.0.6     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">rsample     </span> 1.2.1
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">dials       </span> 1.3.0     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">tune        </span> 1.2.1
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">infer       </span> 1.0.7     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">workflows   </span> 1.1.4
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">modeldata   </span> 1.4.0     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">workflowsets</span> 1.1.0
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">parsnip     </span> 1.2.1     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">yardstick   </span> 1.3.1
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">recipes     </span> 1.1.0     
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── <span class=" -Color -Color-Bold">Conflicts</span> ──────────────────────────────────────────────────────────────────────────────────────────────── tidymodels_conflicts() ──
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">scales</span>::<span class=" -Color -Color-Green">discard()</span> masks <span class=" -Color -Color-Blue">purrr</span>::discard()
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">dplyr</span>::<span class=" -Color -Color-Green">filter()</span>   masks <span class=" -Color -Color-Blue">stats</span>::filter()
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">recipes</span>::<span class=" -Color -Color-Green">fixed()</span>  masks <span class=" -Color -Color-Blue">stringr</span>::fixed()
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">dplyr</span>::<span class=" -Color -Color-Green">lag()</span>      masks <span class=" -Color -Color-Blue">stats</span>::lag()
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">yardstick</span>::<span class=" -Color -Color-Green">spec()</span> masks <span class=" -Color -Color-Blue">readr</span>::spec()
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">recipes</span>::<span class=" -Color -Color-Green">step()</span>   masks <span class=" -Color -Color-Blue">stats</span>::step()
<span class=" -Color -Color-Blue">•</span> Dig deeper into tidy modeling with R at <span class=" -Color -Color-Green">https://www.tmwr.org</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attaching package: ‘palmerpenguins’
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following object is masked from ‘package:modeldata’:

    penguins
</pre></div>
</div>
</div>
</div>
<section id="day-3-learning-objectives">
<h2>Day 3 Learning Objectives<a class="headerlink" href="#day-3-learning-objectives" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Compute the Euclidean distance between points on a graph</p></li>
<li><p>Implement the K-nearest neighbours classification algorithm</p></li>
<li><p>Describe the importance of a training and test set in machine learning</p></li>
<li><p>Explain the use and importance of cross-validation</p></li>
<li><p>Compare and contrast a variety of performance metrics</p></li>
<li><p>Execute the K-nearest neighbours regression algorithm</p></li>
<li><p>Understand the difference between regression and classification</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="classification">
<h1>1. Classification<a class="headerlink" href="#classification" title="Link to this heading">#</a></h1>
<p><strong>Machine learning</strong> is a field where computers learn from data and make decisions and predictions. <strong>Classification</strong> is a type of machine learning, where the goal is to predict a categorical class of an observation given other variables (features). For example:</p>
<ul class="simple">
<li><p>Classifying an email as “spam” or “not spam”</p></li>
<li><p>Classifying a medical test as “positive” or “negative”</p></li>
<li><p>Classifying a bank transaction as fraudulent or not</p></li>
</ul>
<p>Suppose we have past data of cancer tumour cell diagnosis labelled “benign” and “malignant”. Do you think a new cell with Concavity = 3.3 and Perimeter = 0.2 would be malignant? How did you decide?</p>
<center><img src="https://datasciencebook.ca/_main_files/figure-html/05-multiknn-3-1.png" width="700"/></center><section id="what-kind-of-data-analysis-question-is-this">
<h2>What kind of data analysis question is this?<a class="headerlink" href="#what-kind-of-data-analysis-question-is-this" title="Link to this heading">#</a></h2>
<p>Descriptive, exploratory, predictive, inferential, causal, or mechanistic?</p>
</section>
<section id="training-and-test-sets">
<h2>1.2 Training and Test Sets<a class="headerlink" href="#training-and-test-sets" title="Link to this heading">#</a></h2>
<p>When building a machine learning model, typically we start by dividing our data into two sets:</p>
<ol class="arabic simple">
<li><p>Training set</p></li>
<li><p>Test set</p></li>
</ol>
<p>The <strong>training set</strong> is a subset of our data that is used is to train or teach our model to perform sort of predictive task. Then, using our <strong>test set</strong>, we can evaluate how well our model performs on unseen data.</p>
<p>There are two important things to do when splitting data.</p>
<ol class="arabic simple">
<li><p><strong>Shuffling:</strong> randomly reorder the data before splitting</p></li>
<li><p><strong>Stratification:</strong> make sure the two split subsets of data have roughly equal proportions of the different labels</p></li>
</ol>
<center>
<img src="https://datasciencebook.ca/img/classification2/training_test.png" width="1100"/>
</center>
<section id="golden-rule-of-machine-learning-statistics">
<h3>Golden Rule of Machine Learning / Statistics:<a class="headerlink" href="#golden-rule-of-machine-learning-statistics" title="Link to this heading">#</a></h3>
<p><strong>Don’t use your testing data to train your model!</strong></p>
<p>Showing your classifier the labels of evaluation data is like cheating on a test; it’ll look more accurate than it really is.</p>
</section>
</section>
<section id="k-nearest-neighbours-classification">
<h2>1.3 K-nearest neighbours classification<a class="headerlink" href="#k-nearest-neighbours-classification" title="Link to this heading">#</a></h2>
<p><em>Predict the label / class for a new observation using the K closest points from our dataset.</em></p>
<ol class="arabic simple">
<li><p>Compute the distance between the new observation and each observation in our <em>training set</em><br><br></p></li>
</ol>
<center>
<img src="https://ubc-dsci.github.io/introduction-to-datascience/_main_files/figure-html/05-knn-4-1.png" width="600"/></center><center>
$\text{Distance} = \sqrt{(x_{\text{new}} - x_{\text{train}})^2 + (y_{\text{new}} - y_{\text{train}})^2}$
</center><ul class="simple">
<li><p>The new point is at perimeter <span class="math notranslate nohighlight">\(= 0.2\)</span>, concavity <span class="math notranslate nohighlight">\(= 3.3\)</span></p></li>
<li><p>Recall that the training dataset is the sample of data used to fit the model.</p></li>
<li><p>Suppose we have a set of data and we want to predict the class of a new observation. We first want to calculate the distance between the new observation and the other points and predict the label / class for a new observation using the <span class="math notranslate nohighlight">\(K\)</span> closest points from our dataset.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Sort the data in ascending order according to the distances</p></li>
<li><p>Choose the top K rows as “neighbours”</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## # A tibble: 5 x 5</span>
<span class="c1">##        ID Perimeter Concavity Class dist_from_new</span>
<span class="c1">##     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;         &lt;dbl&gt;</span>
<span class="c1">## 1   86409     0.241      2.65 B             0.881</span>
<span class="c1">## 2  887181     0.750      2.87 M             0.980</span>
<span class="c1">## 3  899667     0.623      2.54 M             1.14 </span>
<span class="c1">## 4  907914     0.417      2.31 M             1.26 </span>
<span class="c1">## 5 8710441    -1.16       4.04 B             1.28</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Classify the new observation based on majority vote.</p></li>
</ol>
<center>
<img src="https://ubc-dsci.github.io/introduction-to-datascience/_main_files/figure-html/05-knn-5-1.png" width="600"/>
</center>
<section id="what-would-the-predicted-class-be">
<h3>What would the predicted class be?<a class="headerlink" href="#what-would-the-predicted-class-be" title="Link to this heading">#</a></h3>
</section>
<section id="we-can-go-beyond-2-predictors">
<h3>We can go beyond 2 predictors!<a class="headerlink" href="#we-can-go-beyond-2-predictors" title="Link to this heading">#</a></h3>
<p>For two observations <span class="math notranslate nohighlight">\(u, v\)</span>, each with <span class="math notranslate nohighlight">\(m\)</span> variables (columns) labelled <span class="math notranslate nohighlight">\(1, \dots, m\)</span>,
<br>
<br></p>
<center>
   $\text{Distance} = \sqrt{(u_1-v_1)^2 + (u_2-v_2)^2 + \dots + (u_m - v_m)^2}$ 
</center>
<p>Aside from that, it’s the same algorithm!</p>
</section>
</section>
<section id="standardizing-data">
<h2>1.4 Standardizing Data<a class="headerlink" href="#standardizing-data" title="Link to this heading">#</a></h2>
<center><img src="img/scaling_example1.png" width="600"/></center><center><img src="img/scaling_example2.png" width="600"/></center><ul class="simple">
<li><p>When using K-nearest neighbour classification, the scale of each variable (i.e., its size and range of values) matters. e.g. Salary (10,000+) and Age (0-100)</p></li>
<li><p>Since the classifier predicts classes by identifying observations that are nearest to it, any variables that have a large scale will have a much larger effect than variables with a small scale.</p></li>
<li><p>But just because a variable has a large scale doesn’t mean that it is more important for making accurate predictions.</p></li>
<li><p>For example, suppose you have a data set with two attributes, height (in feet) and weight (in pounds).</p></li>
</ul>
<p>distance1 = sqrt((202 - 200)^2 + (6 - 6)^2) = 2</p>
<p>distance2 = sqrt((200 - 200)^2 + (8 - 6)^2) = 2</p>
<p>Here if we calculate the distance we get 2 in both cases! A difference of 2 pounds is not that big, but a different in 2 feet is a lot. So how can we adjust for this?</p>
<section id="nonstandardized-data-vs-standardized-data">
<h3>Nonstandardized Data vs. Standardized Data<a class="headerlink" href="#nonstandardized-data-vs-standardized-data" title="Link to this heading">#</a></h3>
<p>What if one variable is much larger than the other?</p>
<p><em>Standardize:</em> shift and scale so that the average is 0 and the standard deviation is 1.</p>
<br>
<center>
<img src="https://ubc-dsci.github.io/introduction-to-datascience/_main_files/figure-html/05-scaling-plt-1.png" width="1200"/>
</center>
<ul class="simple">
<li><p>Standardization: when all variables in a data set have a mean (center) of 0 and a standard deviation (scale) of 1, we say that the data have been standardized.</p></li>
</ul>
<ul class="simple">
<li><p>In the plot with the original data above, its very clear that K-nearest neighbours would classify the red dot (new observation) as malignant. However, once we standardize the data, the diagnosis class labelling becomes less clear, and appears it would depend upon the choice of<br />
<span class="math notranslate nohighlight">\(K\)</span>.</p></li>
<li><p>Thus, standardizing the data can change things in an important way when we are using predictive algorithms. As a rule of thumb, standardizing your data should be a part of the preprocessing you do before any predictive modelling / analysis.</p></li>
</ul>
</section>
</section>
<section id="tidymodels-package-in-r">
<h2>1.5 <code class="docutils literal notranslate"><span class="pre">tidymodels</span></code> package in R<a class="headerlink" href="#tidymodels-package-in-r" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">tidymodels</span></code> is a collection of packages and handles computing distances, standardization, balancing, and prediction for us!</p>
<center>
    <img src = "https://i0.wp.com/rviews.rstudio.com/post/2019-06-14-a-gentle-intro-to-tidymodels_files/figure-html/tidymodels.png?zoom=2&w=578&ssl=1" width="800"/>
    </center>
Source: https://www.r-bloggers.com/2019/06/a-gentle-introduction-to-tidymodels/<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data on cancer tumors</span>
<span class="n">tumors</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&quot;data/clean-wdbc.data.csv&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">mutate</span><span class="p">(</span><span class="n">Class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as_factor</span><span class="p">(</span><span class="n">Class</span><span class="p">))</span>

<span class="nf">head</span><span class="p">(</span><span class="n">tumors</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Rows: </span><span class=" -Color -Color-Blue">569</span> <span class=" -Color -Color-Bold">Columns: </span><span class=" -Color -Color-Blue">12</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">──</span> <span class=" -Color -Color-Bold">Column specification</span> <span class=" -Color -Color-Cyan">───────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>
<span class=" -Color -Color-Bold">Delimiter:</span> &quot;,&quot;
<span class=" -Color -Color-Red">chr</span>  (1): Class
<span class=" -Color -Color-Green">dbl</span> (11): ID, Radius, Texture, Perimeter, Area, Smoothness, Compactness, Con...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">ℹ</span> Use `spec()` to retrieve the full column specification for this data.
<span class=" -Color -Color-Cyan">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.
</pre></div>
</div>
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 12</caption>
<thead>
	<tr><th scope=col>ID</th><th scope=col>Class</th><th scope=col>Radius</th><th scope=col>Texture</th><th scope=col>Perimeter</th><th scope=col>Area</th><th scope=col>Smoothness</th><th scope=col>Compactness</th><th scope=col>Concavity</th><th scope=col>Concave_points</th><th scope=col>Symmetry</th><th scope=col>Fractal_dimension</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>  842302</td><td>M</td><td> 1.8850310</td><td>-1.35809849</td><td> 2.3015755</td><td> 1.9994782</td><td> 1.3065367</td><td> 2.6143647</td><td> 2.1076718</td><td>2.2940576</td><td> 2.7482041</td><td> 1.9353117</td></tr>
	<tr><td>  842517</td><td>M</td><td> 1.8043398</td><td>-0.36887865</td><td> 1.5337764</td><td> 1.8888270</td><td>-0.3752817</td><td>-0.4300658</td><td>-0.1466200</td><td>1.0861286</td><td>-0.2436753</td><td> 0.2809428</td></tr>
	<tr><td>84300903</td><td>M</td><td> 1.5105411</td><td>-0.02395331</td><td> 1.3462906</td><td> 1.4550043</td><td> 0.5269438</td><td> 1.0819801</td><td> 0.8542223</td><td>1.9532817</td><td> 1.1512420</td><td> 0.2012142</td></tr>
	<tr><td>84348301</td><td>M</td><td>-0.2812170</td><td> 0.13386631</td><td>-0.2497196</td><td>-0.5495377</td><td> 3.3912907</td><td> 3.8899747</td><td> 1.9878392</td><td>2.1738732</td><td> 6.0407261</td><td> 4.9306719</td></tr>
	<tr><td>84358402</td><td>M</td><td> 1.2974336</td><td>-1.46548091</td><td> 1.3373627</td><td> 1.2196511</td><td> 0.2203623</td><td>-0.3131190</td><td> 0.6126397</td><td>0.7286181</td><td>-0.8675896</td><td>-0.3967505</td></tr>
	<tr><td>  843786</td><td>M</td><td>-0.1653528</td><td>-0.31356043</td><td>-0.1149083</td><td>-0.2441054</td><td> 2.0467119</td><td> 1.7201029</td><td> 1.2621327</td><td>0.9050914</td><td> 1.7525273</td><td> 2.2398308</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">tidymodels</span></code>, the <code class="docutils literal notranslate"><span class="pre">recipes</span></code> package is named after cooking terms.</p>
<section id="make-a-recipe-to-specify-the-predictors-response-and-preprocess-the-data">
<h3>1. Make a <code class="docutils literal notranslate"><span class="pre">recipe</span></code> to specify the predictors/response and preprocess the data<a class="headerlink" href="#make-a-recipe-to-specify-the-predictors-response-and-preprocess-the-data" title="Link to this heading">#</a></h3>
<ol class="arabic">
<li><p><code class="docutils literal notranslate"><span class="pre">recipe()</span></code>:  Main argument in the formula.</p>
<p>Arguments:</p>
<ul class="simple">
<li><p>formula</p></li>
<li><p>data</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">prep()</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">bake()</span></code>: you can also <code class="docutils literal notranslate"><span class="pre">prep</span></code> and <code class="docutils literal notranslate"><span class="pre">bake</span></code> a recipe to see what the preprocessing does!</p></li>
</ol>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">prep()</span></code> function computes everything so that the preprocessing steps can be executed</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">bake()</span></code> function takes a recipe and applies it to data and returns data</p></li>
<li><p>visit https://recipes.tidymodels.org/reference/index.html to see all the preprocessing steps</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standardize the data</span>

<span class="n">tumor_recipe</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">recipe</span><span class="p">(</span><span class="n">Class</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Perimeter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Concavity</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">tumors</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">                  </span><span class="nf">step_center</span><span class="p">(</span><span class="nf">all_predictors</span><span class="p">())</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">                  </span><span class="nf">step_scale</span><span class="p">(</span><span class="nf">all_predictors</span><span class="p">())</span><span class="w"> </span>
<span class="n">tumor_recipe</span><span class="w">           </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">──</span> <span class=" -Color -Color-Bold">Recipe</span> <span class=" -Color -Color-Cyan">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── Inputs 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of variables by role
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>outcome:   1
predictor: 2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── Operations 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">•</span> Centering for: <span class=" -Color -Color-Blue">all_predictors()</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">•</span> Scaling for: <span class=" -Color -Color-Blue">all_predictors()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="build-a-model-specification-model-spec-to-specify-the-model-and-training-algorithm">
<h3>2. Build a model specification (<code class="docutils literal notranslate"><span class="pre">model_spec</span></code>) to specify the model and training algorithm<a class="headerlink" href="#build-a-model-specification-model-spec-to-specify-the-model-and-training-algorithm" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>model type</strong>: kind of model you want to fit</p></li>
<li><p><strong>arguments</strong>: model parameter values</p></li>
<li><p><strong>engine</strong>: underlying package the model should come from</p></li>
<li><p><strong>mode</strong>: type of prediction (some packages can do both classification and regression)</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build a model specification using nearest_neighbor</span>

<span class="n">tumor_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">nearest_neighbor</span><span class="p">(</span><span class="n">weight_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;rectangular&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">neighbors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">       </span><span class="nf">set_engine</span><span class="p">(</span><span class="s">&quot;kknn&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">       </span><span class="nf">set_mode</span><span class="p">(</span><span class="s">&quot;classification&quot;</span><span class="p">)</span>

<span class="n">tumor_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>K-Nearest Neighbor Model Specification (classification)

Main Arguments:
  neighbors = 3
  weight_func = rectangular

Computational engine: kknn 
</pre></div>
</div>
</div>
</div>
</section>
<section id="put-them-together-in-a-workflow-and-then-fit-it">
<h3>3. Put them together in a workflow and then <code class="docutils literal notranslate"><span class="pre">fit</span></code> it<a class="headerlink" href="#put-them-together-in-a-workflow-and-then-fit-it" title="Link to this heading">#</a></h3>
<p>We may want to use our recipe across several steps as we train and test our model. To simplify this process, we can use a model workflow, which pairs a model and recipe together.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a workflow</span>

<span class="n">tumor_workflow</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">workflow</span><span class="p">()</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">add_recipe</span><span class="p">(</span><span class="n">tumor_recipe</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">add_model</span><span class="p">(</span><span class="n">tumor_model</span><span class="p">)</span>

<span class="n">tumor_fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tumor_workflow</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">fit</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">tumors</span><span class="p">)</span>

<span class="n">tumor_workflow</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>══ Workflow ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: nearest_neighbor()

── Preprocessor ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
2 Recipe Steps

• step_center()
• step_scale()

── Model ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
K-Nearest Neighbor Model Specification (classification)

Main Arguments:
  neighbors = 3
  weight_func = rectangular

Computational engine: kknn 
</pre></div>
</div>
</div>
</div>
</section>
<section id="predict-a-new-class-label-using-predict">
<h3>4. Predict a new class label using <code class="docutils literal notranslate"><span class="pre">predict</span></code><a class="headerlink" href="#predict-a-new-class-label-using-predict" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">predict()</span></code> applies the recipe to the new data, then passes them to the fitted model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">new_obs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tibble</span><span class="p">(</span><span class="n">Perimeter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="n">Concavity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3.3</span><span class="p">)</span>

<span class="nf">predict</span><span class="p">(</span><span class="n">tumor_fit</span><span class="p">,</span><span class="w"> </span><span class="n">new_obs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 1</caption>
<thead>
	<tr><th scope=col>.pred_class</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><td>M</td></tr>
</tbody>
</table>
</div></div>
</div>
<center>
<img src="https://ubc-dsci.github.io/introduction-to-datascience/_main_files/figure-html/05-knn-5-1.png" width = "600"/>
</center><ul class="simple">
<li><p>What would happen to the prediction if we changed <code class="docutils literal notranslate"><span class="pre">Perimeter</span></code> to <code class="docutils literal notranslate"><span class="pre">-2</span></code>?</p></li>
</ul>
</section>
</section>
<section id="how-to-measure-classifier-performance">
<h2>1.6 How to measure classifier performance?<a class="headerlink" href="#how-to-measure-classifier-performance" title="Link to this heading">#</a></h2>
</br>
<section id="accuracy">
<h3>Accuracy<a class="headerlink" href="#accuracy" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[Accuracy  = \dfrac{\#\; correct\; predictions}{\#\; total\; predictions}\]</div>
<p>Downside: doesn’t tell you the type of mistake being made</p>
<p>Here is an example of confusion matrix with cancer diagnosis data we’ve seen before.</p>
</br>
<table>
<thead style="font-size: 32px";>
<tr class="header">
<th></th>
<th>Truly Malignant</th>
<th>Truly Benign</th>
</tr>
</thead>
<tbody style="font-size: 32px";>
<tr class="odd">
<td><strong>Predicted Malignant</strong></td>
<td>1</td>
<td>4</td>
</tr>
<tr class="even">
<td><strong>Predicted Benign</strong></td>
<td>3</td>
<td>57</td>
</tr>
</tbody>
</table>
</br>
<p>Typically we consider one of the class labels as “positive” - in this case the “Malignant” status is more interesting to researchers, hence we consider that label as “positive”.</p>
<p>Relabeling the above confusion matrix:</p>
</br>
<table>
<thead style="font-size: 32px";>
<tr class="header">
<th></th>
<th>Truly Positive</th>
<th>Truly Negative</th>
</tr>
</thead>
<tbody style="font-size: 32px";>
<tr class="odd">
<td><strong>Predicted Positive</strong></td>
<td>1</td>
<td>4</td>
</tr>
<tr class="even">
<td><strong>Predicted Negative</strong></td>
<td>3</td>
<td>57</td>
</tr>
</tbody>
</table>
</br>
<p>Note that:</p>
<ul class="simple">
<li><p>Top left cell = # correct positive predictions.</p></li>
<li><p>Top <em>row</em> = # total positive predictions.</p></li>
<li><p>Left <em>column</em> = # truly positive observations.</p></li>
</ul>
</section>
<section id="precision-and-recall">
<h3>Precision and Recall<a class="headerlink" href="#precision-and-recall" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[
{Precision}  = \dfrac{{\#\; correct\; positive\; predictions}}{{\#\; total\; positive\; predictions}} \quad\quad\quad \quad {Recall}  = \dfrac{{\#\; correct\; positive\; predictions}}{{\#\; total\; truly\; positive\; observations}}
\]</div>
<p>In the above confusion matrix, precision = 1/(1+4) and recall = 1/(1+3).</p>
<p><strong>Precision</strong> quantifies how many of the positive predictions the classifier made were actually positive. Intuitively, we would like a classifier to have a high precision: for a classifier with high precision, if the classifier reports that a new observation is positive, we can trust that the new observation is indeed positive.</p>
<p><strong>Recall</strong> quantifies how many of the positive observations in the test set were identified as positive. Intuitively, we would like a classifier to have a high recall: for a classifier with high recall, if there is a positive observation in the test data, we can trust that the classifier will find it.</p>
<section id="in-class-question">
<h4>In-class Question<a class="headerlink" href="#in-class-question" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>a 99% accuracy on cancer prediction may not be very useful. Why?</p></li>
<li><p>If we need patients with truly malignant cancer to be diagnosed correctly, what metric should we prioritize?</p></li>
<li><p>What if a classifier never guess positive except for the very few observations it is super confident in? What metric is affected?</p></li>
</ul>
<p>To add evaluation into our classification pipeline, we:</p>
<p>i.) Split our data into two subsets: <em>training data</em> and <em>testing data</em> (discussed above).</p>
<p>ii.) Build the model &amp; choose K using training data only (sometimes called tuning)</p>
<p>iii.) Compute performance metrics (accuracy, precision, recall, etc.) by predicting labels on testing data only</p>
<p>We’ll now talk about these steps below.</p>
</section>
</section>
</section>
<section id="choosing-k-or-tuning-the-model">
<h2>1.7 Choosing K (or, “tuning’’ the model)<a class="headerlink" href="#choosing-k-or-tuning-the-model" title="Link to this heading">#</a></h2>
<p><strong>Choosing K is part of training.</strong> We want to choose K to maximize performance, but:</p>
<ul class="simple">
<li><p>we can’t use test data to evaluate performance (cheating!)</p></li>
<li><p>we can’t use training data to evaluate performance (that’s what we trained with, so poor evaluation of true performance)</p></li>
</ul>
<p><strong>Solution:</strong> Split the training data further into <em>training data</em> and <em>validation data sets</em></p>
<p><br>a. Choose some candidate values of K
<br>b. Split the <strong>training data</strong> into two sets - one called the <strong>training set</strong>, another called the <strong>validation set</strong>
<br>c. For each K, train the model using <strong>training set only</strong>
<br>d. Evaluate accuracy (and/or other metrics of performance) for each using <strong>validation set only</strong>
<br>e. Pick the K that maximizes validation performance</p>
<p><em>But what if we get a bad training set? Just by chance?</em></p>
<section id="cross-validation">
<h3>Cross-Validation<a class="headerlink" href="#cross-validation" title="Link to this heading">#</a></h3>
<p>We can get a better estimate of performance by splitting <em>multiple ways</em> and <em>averaging</em>. Here’s an example:</p>
<center>
<img src="https://datasciencebook.ca/img/classification2/cv.png" width="1000"/>
</center></section>
<section id="underfitting-overfitting">
<h3>Underfitting &amp; Overfitting<a class="headerlink" href="#underfitting-overfitting" title="Link to this heading">#</a></h3>
<p><strong>Overfitting:</strong> when your model is too sensitive to your training data; noise can influence predictions!</p>
<p><strong>Underfitting:</strong> when your model isn’t sensitive enough to training data; useful information is ignored!</p>
<center>
<img width="1000" src="img/under_over_fitting.png">
</center>
<p>Source: http://kerckhoffs.schaathun.net/FPIA/Slides/09OF.pdf</p>
</section>
<section id="id1">
<h3>Underfitting &amp; Overfitting<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Which of these are under-, over-, and good fits?</p>
<center>
<img width="1000px" src="https://datasciencebook.ca/_main_files/figure-html/06-decision-grid-K-1.png"/>
</center>
</section>
<section id="id2">
<h3>Underfitting &amp; Overfitting<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>For KNN: small K overfits, large K underfits, both result in lower accuracy</p>
<center>
<img src="https://datasciencebook.ca/_main_files/figure-html/06-lots-of-ks-1.png"/>
</center></section>
</section>
<section id="compute-performance-metrics">
<h2>1.8 Compute performance metrics<a class="headerlink" href="#compute-performance-metrics" title="Link to this heading">#</a></h2>
<p>The role of the test data:</p>
<center>
<img src="https://datasciencebook.ca/img/classification2/ML-paradigm-test.png" width="1700"/>
</center><section id="the-big-picture">
<h3>The Big Picture<a class="headerlink" href="#the-big-picture" title="Link to this heading">#</a></h3>
<center>
<img align="left" src="https://datasciencebook.ca/img/classification2/train-test-overview.png" width="1200"/></center><p>Now, let’s put it all together and look into how to go about this process in R. First let’s split our data into training and test sets:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split data</span>

<span class="nf">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c1"># set seed for reproducibility</span>

<span class="n">tumor_split</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">initial_split</span><span class="p">(</span><span class="n">tumors</span><span class="p">,</span><span class="w"> </span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">,</span><span class="w"> </span><span class="n">strata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">)</span>
<span class="n">tumor_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">training</span><span class="p">(</span><span class="n">tumor_split</span><span class="p">)</span><span class="w"> </span><span class="c1"># training set </span>
<span class="n">tumor_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">testing</span><span class="p">(</span><span class="n">tumor_split</span><span class="p">)</span><span class="w"> </span><span class="c1"># testing set </span>
</pre></div>
</div>
</div>
</div>
<p>What is the proportion of malignant tumors in our training set?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tumor_proportions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tumor_train</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">                      </span><span class="nf">group_by</span><span class="p">(</span><span class="n">Class</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">                      </span><span class="nf">summarize</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">n</span><span class="p">())</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">                      </span><span class="nf">mutate</span><span class="p">(</span><span class="n">percent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="nf">nrow</span><span class="p">(</span><span class="n">tumor_train</span><span class="p">))</span>

<span class="n">tumor_proportions</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 2 × 3</caption>
<thead>
	<tr><th scope=col>Class</th><th scope=col>n</th><th scope=col>percent</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>M</td><td>159</td><td>37.32394</td></tr>
	<tr><td>B</td><td>267</td><td>62.67606</td></tr>
</tbody>
</table>
</div></div>
</div>
<ul class="simple">
<li><p>Standardize the <strong>training</strong> data:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tumor_recipe</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">recipe</span><span class="p">(</span><span class="n">Class</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Smoothness</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Concavity</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tumor_train</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">step_scale</span><span class="p">(</span><span class="nf">all_predictors</span><span class="p">())</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">step_center</span><span class="p">(</span><span class="nf">all_predictors</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Instead of specifying <span class="math notranslate nohighlight">\(K\)</span> in our model specification, we can set <code class="docutils literal notranslate"><span class="pre">neighbors</span> <span class="pre">=</span> <span class="pre">tune()</span></code> to later select the optimal <span class="math notranslate nohighlight">\(K\)</span> using cross-validation.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tumor_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">nearest_neighbor</span><span class="p">(</span><span class="n">weight_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;rectangular&quot;</span><span class="p">,</span>
<span class="w">                              </span><span class="n">neighbors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">tune</span><span class="p">())</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">                  </span><span class="nf">set_engine</span><span class="p">(</span><span class="s">&quot;kknn&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">                  </span><span class="nf">set_mode</span><span class="p">(</span><span class="s">&quot;classification&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>After, we can use the <code class="docutils literal notranslate"><span class="pre">tune_grid</span></code> function in our workflow for a range of potential values for <span class="math notranslate nohighlight">\(K\)</span> and fit the model with the training data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tumor_vfold</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">vfold_cv</span><span class="p">(</span><span class="n">tumor_train</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">strata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">)</span>

<span class="n">k_vals</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tibble</span><span class="p">(</span><span class="n">neighbors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">))</span>

<span class="n">knn_fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">workflow</span><span class="p">()</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">add_recipe</span><span class="p">(</span><span class="n">tumor_recipe</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">add_model</span><span class="p">(</span><span class="n">tumor_model</span><span class="p">)</span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">tune_grid</span><span class="p">(</span><span class="n">resamples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tumor_vfold</span><span class="p">,</span><span class="w"> </span><span class="n">grid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k_vals</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">collect_metrics</span><span class="p">()</span>

<span class="n">accuracies</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">knn_fit</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">.metric</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;accuracy&quot;</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 7</caption>
<thead>
	<tr><th scope=col>neighbors</th><th scope=col>.metric</th><th scope=col>.estimator</th><th scope=col>mean</th><th scope=col>n</th><th scope=col>std_err</th><th scope=col>.config</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td> 1</td><td>accuracy</td><td>binary</td><td>0.7840636</td><td>5</td><td>0.016340207</td><td>Preprocessor1_Model01</td></tr>
	<tr><td> 6</td><td>accuracy</td><td>binary</td><td>0.8403746</td><td>5</td><td>0.006980546</td><td>Preprocessor1_Model02</td></tr>
	<tr><td>11</td><td>accuracy</td><td>binary</td><td>0.8310175</td><td>5</td><td>0.007745668</td><td>Preprocessor1_Model03</td></tr>
	<tr><td>16</td><td>accuracy</td><td>binary</td><td>0.8451918</td><td>5</td><td>0.014306532</td><td>Preprocessor1_Model04</td></tr>
	<tr><td>21</td><td>accuracy</td><td>binary</td><td>0.8663155</td><td>5</td><td>0.019746677</td><td>Preprocessor1_Model05</td></tr>
	<tr><td>26</td><td>accuracy</td><td>binary</td><td>0.8569025</td><td>5</td><td>0.020014323</td><td>Preprocessor1_Model06</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_vs_k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">accuracies</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neighbors</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Neighbors&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Accuracy Estimate&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span>

<span class="n">accuracy_vs_k</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/aaa5a6e733b40594e9a46eceaf7ac88464fa407f6984dd99f91365ba7ab21d74.png"><img alt="../_images/aaa5a6e733b40594e9a46eceaf7ac88464fa407f6984dd99f91365ba7ab21d74.png" src="../_images/aaa5a6e733b40594e9a46eceaf7ac88464fa407f6984dd99f91365ba7ab21d74.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">best_k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">accuracies</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">        </span><span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">mean</span><span class="p">))</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">        </span><span class="nf">head</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">        </span><span class="nf">pull</span><span class="p">(</span><span class="n">neighbors</span><span class="p">)</span>
<span class="n">best_k</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">21</div></div>
</div>
<p>Let’s fit our model with our “best” <span class="math notranslate nohighlight">\(K\)</span> value.</p>
<blockquote>
<div><p><em>Note: In the worksheet, we will provide you with a <span class="math notranslate nohighlight">\(K\)</span> value to use and you won’t need to perform cross-validation, but it is still good to understand the motivation behind it!</em></p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tumor_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">nearest_neighbor</span><span class="p">(</span><span class="n">weight_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;rectangular&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">neighbors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">best_k</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">set_engine</span><span class="p">(</span><span class="s">&quot;kknn&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">set_mode</span><span class="p">(</span><span class="s">&quot;classification&quot;</span><span class="p">)</span>

<span class="n">tumor_fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">workflow</span><span class="p">()</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">add_recipe</span><span class="p">(</span><span class="n">tumor_recipe</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">add_model</span><span class="p">(</span><span class="n">tumor_model</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">fit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tumor_train</span><span class="p">)</span>

<span class="n">tumor_fit</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>══ Workflow [trained] ═════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: nearest_neighbor()

── Preprocessor ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
2 Recipe Steps

• step_scale()
• step_center()

── Model ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

Call:
kknn::train.kknn(formula = ..y ~ ., data = data, ks = min_rows(21,     data, 5), kernel = ~&quot;rectangular&quot;)

Type of response variable: nominal
Minimal misclassification: 0.1384977
Best kernel: rectangular
Best k: 21
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Now, we can make predictions on our test set!</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tumor_test_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">tumor_fit</span><span class="p">,</span><span class="w"> </span><span class="n">tumor_test</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">bind_cols</span><span class="p">(</span><span class="n">tumor_test</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">tumor_test_predictions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 13</caption>
<thead>
	<tr><th scope=col>.pred_class</th><th scope=col>ID</th><th scope=col>Class</th><th scope=col>Radius</th><th scope=col>Texture</th><th scope=col>Perimeter</th><th scope=col>Area</th><th scope=col>Smoothness</th><th scope=col>Compactness</th><th scope=col>Concavity</th><th scope=col>Concave_points</th><th scope=col>Symmetry</th><th scope=col>Fractal_dimension</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>M</td><td>84501001</td><td>M</td><td>-0.2439749</td><td>2.4409613</td><td>-0.2860264</td><td>-0.297147713</td><td> 2.3182555</td><td> 5.1083824</td><td> 3.991920</td><td> 1.61859101</td><td> 2.3683599</td><td> 6.8408368</td></tr>
	<tr><td>B</td><td>  846381</td><td>M</td><td> 0.1181009</td><td>0.3225990</td><td> 0.1410247</td><td>-0.007171473</td><td>-0.8439134</td><td>-0.3932021</td><td>-0.191677</td><td>-0.04117035</td><td>-0.1483101</td><td>-1.1669069</td></tr>
	<tr><td>M</td><td>84799002</td><td>M</td><td> 0.2463792</td><td>1.8633740</td><td> 0.5011165</td><td> 0.109978225</td><td> 1.5518018</td><td> 2.5641538</td><td> 2.063094</td><td> 0.86097309</td><td> 2.1291389</td><td> 2.7768917</td></tr>
	<tr><td>M</td><td>  849014</td><td>M</td><td> 2.2864179</td><td>0.8464951</td><td> 2.3670467</td><td> 2.665141363</td><td> 0.8247658</td><td> 0.3860195</td><td> 1.270281</td><td> 1.88938618</td><td>-0.2145808</td><td>-0.4316318</td></tr>
	<tr><td>M</td><td>  852763</td><td>M</td><td> 0.2794833</td><td>1.2255875</td><td> 0.4505251</td><td> 0.028658420</td><td> 0.8817023</td><td> 2.6061021</td><td> 1.350329</td><td> 2.36555969</td><td> 2.2034913</td><td> 2.4114688</td></tr>
	<tr><td>M</td><td>  853401</td><td>M</td><td> 1.4236429</td><td>1.3557481</td><td> 1.5843678</td><td> 1.386505974</td><td> 0.7327913</td><td> 1.0896071</td><td> 1.635052</td><td> 1.06787276</td><td> 0.8780775</td><td> 0.7681733</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Finally, we can look at evaluation measures for our model such as accuracy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tumor_test_predictions</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">metrics</span><span class="p">(</span><span class="n">truth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">,</span><span class="w"> </span><span class="n">estimate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.pred_class</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">.metric</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;accuracy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 3</caption>
<thead>
	<tr><th scope=col>.metric</th><th scope=col>.estimator</th><th scope=col>.estimate</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>accuracy</td><td>binary</td><td>0.8671329</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Take a look at the confusion matrix below. Using the table, verify that the accuracy was computed correctly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">confusion</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tumor_test_predictions</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">             </span><span class="nf">conf_mat</span><span class="p">(</span><span class="n">truth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">,</span><span class="w"> </span><span class="n">estimate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.pred_class</span><span class="p">)</span>
<span class="n">confusion</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Truth
Prediction  M  B
         M 42  8
         B 11 82
</pre></div>
</div>
</div>
</div>
</section>
<section id="question">
<h3>Question<a class="headerlink" href="#question" title="Link to this heading">#</a></h3>
<p>What are the precision and recall for the classifier on the test data?</p>
<p>We can use the precision and recall functions from <code class="docutils literal notranslate"><span class="pre">tidymodels</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tumor_test_predictions</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">precision</span><span class="p">(</span><span class="n">truth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">,</span><span class="w"> </span><span class="n">estimate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.pred_class</span><span class="p">,</span><span class="w"> </span><span class="n">event_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;first&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 3</caption>
<thead>
	<tr><th scope=col>.metric</th><th scope=col>.estimator</th><th scope=col>.estimate</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>precision</td><td>binary</td><td>0.84</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tumor_test_predictions</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">recall</span><span class="p">(</span><span class="n">truth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">,</span><span class="w"> </span><span class="n">estimate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.pred_class</span><span class="p">,</span><span class="w"> </span><span class="n">event_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;first&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 3</caption>
<thead>
	<tr><th scope=col>.metric</th><th scope=col>.estimator</th><th scope=col>.estimate</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>recall</td><td>binary</td><td>0.7924528</td></tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="activity">
<h3>Activity<a class="headerlink" href="#activity" title="Link to this heading">#</a></h3>
<p>In a group, discuss the following prompts.</p>
<ul class="simple">
<li><p>Explain what a test and training data set are in your own words</p></li>
<li><p>Explain cross-validation in your own words</p></li>
<li><p>Imagine if we train and evaluate accuracy on all the data. How can I get 100% accuracy, always?</p></li>
</ul>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="regression">
<h1>2. Regression<a class="headerlink" href="#regression" title="Link to this heading">#</a></h1>
<p>What if we want to predict a quantitative value instead of a class label? Say, the sale price of a home.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the data</span>

<span class="n">housing</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&quot;data/housing.csv&quot;</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">housing</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Rows: </span><span class=" -Color -Color-Blue">932</span> <span class=" -Color -Color-Bold">Columns: </span><span class=" -Color -Color-Blue">9</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">──</span> <span class=" -Color -Color-Bold">Column specification</span> <span class=" -Color -Color-Cyan">───────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>
<span class=" -Color -Color-Bold">Delimiter:</span> &quot;,&quot;
<span class=" -Color -Color-Red">chr</span> (3): city, zip, type
<span class=" -Color -Color-Green">dbl</span> (6): beds, baths, sqft, price, latitude, longitude
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">ℹ</span> Use `spec()` to retrieve the full column specification for this data.
<span class=" -Color -Color-Cyan">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.
</pre></div>
</div>
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 9</caption>
<thead>
	<tr><th scope=col>city</th><th scope=col>zip</th><th scope=col>beds</th><th scope=col>baths</th><th scope=col>sqft</th><th scope=col>type</th><th scope=col>price</th><th scope=col>latitude</th><th scope=col>longitude</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>SACRAMENTO</td><td>z95838</td><td>2</td><td>1</td><td> 836</td><td>Residential</td><td>59222</td><td>38.63191</td><td>-121.4349</td></tr>
	<tr><td>SACRAMENTO</td><td>z95823</td><td>3</td><td>1</td><td>1167</td><td>Residential</td><td>68212</td><td>38.47890</td><td>-121.4310</td></tr>
	<tr><td>SACRAMENTO</td><td>z95815</td><td>2</td><td>1</td><td> 796</td><td>Residential</td><td>68880</td><td>38.61830</td><td>-121.4438</td></tr>
	<tr><td>SACRAMENTO</td><td>z95815</td><td>2</td><td>1</td><td> 852</td><td>Residential</td><td>69307</td><td>38.61684</td><td>-121.4391</td></tr>
	<tr><td>SACRAMENTO</td><td>z95824</td><td>2</td><td>1</td><td> 797</td><td>Residential</td><td>81900</td><td>38.51947</td><td>-121.4358</td></tr>
	<tr><td>SACRAMENTO</td><td>z95841</td><td>3</td><td>1</td><td>1122</td><td>Condo      </td><td>89921</td><td>38.66260</td><td>-121.3278</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">housing</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqft</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;House size (square feet)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Price (USD)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">dollar_format</span><span class="p">())</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/07a74448a5175b75d7283fff74c34c564a1ccba5290c67baf8b893cb6fa60fae.png"><img alt="../_images/07a74448a5175b75d7283fff74c34c564a1ccba5290c67baf8b893cb6fa60fae.png" src="../_images/07a74448a5175b75d7283fff74c34c564a1ccba5290c67baf8b893cb6fa60fae.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>E.g.: predict the price of a 2000 square foot home (from this reduced dataset)</p>
<a class="reference internal image-reference" href="https://datasciencebook.ca/_main_files/figure-html/07-small-eda-regr-1.png"><img alt="https://datasciencebook.ca/_main_files/figure-html/07-small-eda-regr-1.png" class="align-left" src="https://datasciencebook.ca/_main_files/figure-html/07-small-eda-regr-1.png" style="width: 600px;" /></a>
<ul class="simple">
<li><p>You can see that we have no observations of a house of size exactly 2,000 square feet</p>
<ul>
<li><p>What are some ways you might predict the price?</p></li>
</ul>
</li>
</ul>
<section id="k-nearest-neighbours-regression">
<h2>2.1 K nearest neighbours regression<a class="headerlink" href="#k-nearest-neighbours-regression" title="Link to this heading">#</a></h2>
<p>As in k-nn classification, we find the <span class="math notranslate nohighlight">\(k\)</span>-nearest neighbours (here <span class="math notranslate nohighlight">\(k=5\)</span>) in terms of the predictors</p>
<a class="reference internal image-reference" href="https://datasciencebook.ca/_main_files/figure-html/07-knn3-example-1.png"><img alt="https://datasciencebook.ca/_main_files/figure-html/07-knn3-example-1.png" class="align-left" src="https://datasciencebook.ca/_main_files/figure-html/07-knn3-example-1.png" style="width: 600px;" /></a>
<p>Then we average the values for the <span class="math notranslate nohighlight">\(k\)</span>-nearest neighbours, and use that as the prediction:</p>
<a class="reference internal image-reference" href="https://datasciencebook.ca/_main_files/figure-html/07-predictedViz-knn-1.png"><img alt="https://datasciencebook.ca/_main_files/figure-html/07-predictedViz-knn-1.png" class="align-left" src="https://datasciencebook.ca/_main_files/figure-html/07-predictedViz-knn-1.png" style="width: 600px;" /></a>
<p>If we do that for a range of house sizes, we can draw the curve of predictions:</p>
<a class="reference internal image-reference" href="https://datasciencebook.ca/_main_files/figure-html/07-predict-all-1.png"><img alt="https://datasciencebook.ca/_main_files/figure-html/07-predict-all-1.png" src="https://datasciencebook.ca/_main_files/figure-html/07-predict-all-1.png" style="width: 600px;" /></a>
<ul class="simple">
<li><p>You can imagine doing this for all the possible input values and coming up with predictions everywhere</p></li>
<li><p>Connecting all these predictions with a line</p></li>
<li><p>one benefit is that it handles non-linearity well.</p></li>
</ul>
</section>
<section id="model-evaluation-and-tuning">
<h2>2.2 Model Evaluation and Tuning<a class="headerlink" href="#model-evaluation-and-tuning" title="Link to this heading">#</a></h2>
<p>We still have to answer these two questions:</p>
<ol class="arabic simple">
<li><p>Is our model any good?</p></li>
<li><p>How do we choose <code class="docutils literal notranslate"><span class="pre">k</span></code>?</p></li>
</ol>
<p>The same general strategy as in classification works here!</p>
<a class="reference internal image-reference" href="https://datasciencebook.ca/img/classification2/train-test-overview.png"><img alt="https://datasciencebook.ca/img/classification2/train-test-overview.png" class="align-left" src="https://datasciencebook.ca/img/classification2/train-test-overview.png" style="width: 700px;" /></a>
<section id="is-our-model-any-good">
<h3>Is our model any good?<a class="headerlink" href="#is-our-model-any-good" title="Link to this heading">#</a></h3>
<p><b><font color="blue">The blue line</font></b> depicts our predictions from k-nn regression. <b><font color="red">The red lines</font></b> depict the error in our predictions, i.e., the difference between the <span class="math notranslate nohighlight">\(i^\text{th}\)</span> test data response and our prediction <span class="math notranslate nohighlight">\(\hat{y}_i\)</span>:</p>
<center>
<img src="img/rmse.jpg" width="600"/>
</center><p>We now have the errors for individual points. How could you combine these errors to report a single measure of error for our model?</p>
<p>We (roughly) add up these errors to evaluate our regression model</p>
<ul class="simple">
<li><p>Not out of 1, but instead in units of the target variable (bit harder to interpret)</p></li>
</ul>
<table>
<tr>
<td>
<p><em>Root Mean Squared Prediction Error</em> (RMSPE):</p>
<div class="math notranslate nohighlight">
\[RMSPE = \sqrt{\frac{1}{n}\sum\limits_{i=1}^{n}(y_i - \hat{y_i})^2}\]</div>
<p align=\"left\">- $n$ is the number of observations</p>
<p align=\"left\">- $y_i$ is the observed value for the $i^\text{th}$ test observation</p>
<p align=\"left\">- $\hat{y_i}$ is the predicted value for the $i^\text{th}$ test observation</p>
</td>
<td><img src="img/rmse.jpg" width="250"/></td>
</tr>
</table><p>We choose <span class="math notranslate nohighlight">\(K\)</span> roughly the same way as before:</p>
<ol class="arabic simple">
<li><p>Cross validation:</p>
<ul class="simple">
<li><p>Split data into <span class="math notranslate nohighlight">\(C\)</span> folds</p></li>
<li><p>Train</p></li>
<li><p>Evaluate model</p></li>
<li><p>Pick k that gives the lowest RMSPE on validation set</p></li>
</ul>
</li>
<li><p>Train model on whole training dataset (not split into folds)</p></li>
<li><p>Evaluate how good the predictions are using the test data</p></li>
</ol>
<p>The process is very similar to what we learned for classification, except for a few minor changes to our model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split the data</span>

<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>

<span class="n">housing_split</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">initial_split</span><span class="p">(</span><span class="n">housing</span><span class="p">,</span><span class="w"> </span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">,</span><span class="w"> </span><span class="n">strata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="p">)</span>
<span class="n">housing_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">training</span><span class="p">(</span><span class="n">housing_split</span><span class="p">)</span>
<span class="n">housing_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">testing</span><span class="p">(</span><span class="n">housing_split</span><span class="p">)</span>

<span class="c1"># Standardize the training data</span>

<span class="n">housing_recipe</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">recipe</span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">sqft</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">housing_train</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">step_scale</span><span class="p">(</span><span class="nf">all_predictors</span><span class="p">())</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">step_center</span><span class="p">(</span><span class="nf">all_predictors</span><span class="p">())</span>

<span class="c1"># Specify the regression model </span>

<span class="n">housing_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">nearest_neighbor</span><span class="p">(</span><span class="n">weight_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;rectangular&quot;</span><span class="p">,</span>
<span class="w">                              </span><span class="n">neighbors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">tune</span><span class="p">())</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">set_engine</span><span class="p">(</span><span class="s">&quot;kknn&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">set_mode</span><span class="p">(</span><span class="s">&quot;regression&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># Note we change this to regression instead of classification</span>

<span class="c1"># Set the folds for cross validation</span>

<span class="n">housing_vfold</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">vfold_cv</span><span class="p">(</span><span class="n">housing_train</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">strata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="p">)</span>

<span class="c1"># Define our workflow </span>

<span class="n">housing_wkflw</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">workflow</span><span class="p">()</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">add_recipe</span><span class="p">(</span><span class="n">housing_recipe</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">add_model</span><span class="p">(</span><span class="n">housing_model</span><span class="p">)</span>

<span class="n">housing_wkflw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>══ Workflow ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: nearest_neighbor()

── Preprocessor ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
2 Recipe Steps

• step_scale()
• step_center()

── Model ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
K-Nearest Neighbor Model Specification (regression)

Main Arguments:
  neighbors = tune()
  weight_func = rectangular

Computational engine: kknn 
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Using cross-validation, we search a grid of potential values for <span class="math notranslate nohighlight">\(K\)</span> between 1 and 200:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">gridvals</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tibble</span><span class="p">(</span><span class="n">neighbors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">))</span>

<span class="n">housing_results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">housing_wkflw</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">tune_grid</span><span class="p">(</span><span class="n">resamples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">housing_vfold</span><span class="p">,</span><span class="w"> </span><span class="n">grid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gridvals</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">collect_metrics</span><span class="p">()</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">.metric</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;rmse&quot;</span><span class="p">)</span>

<span class="c1"># show only the row of minimum RMSPE</span>
<span class="n">housing_min</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">housing_results</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">mean</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">mean</span><span class="p">))</span>

<span class="n">housing_min</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 7</caption>
<thead>
	<tr><th scope=col>neighbors</th><th scope=col>.metric</th><th scope=col>.estimator</th><th scope=col>mean</th><th scope=col>n</th><th scope=col>std_err</th><th scope=col>.config</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td>52</td><td>rmse</td><td>standard</td><td>86615.41</td><td>5</td><td>5486.112</td><td>Preprocessor1_Model18</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>It looks like <span class="math notranslate nohighlight">\(K=52\)</span> gives us the lowest RMSE! Now, let’s evaluate how our model performs on unseen testing data using RMSPE:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">kmin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">52</span>

<span class="n">housing_spec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">nearest_neighbor</span><span class="p">(</span><span class="n">weight_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;rectangular&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">neighbors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kmin</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">set_engine</span><span class="p">(</span><span class="s">&quot;kknn&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">set_mode</span><span class="p">(</span><span class="s">&quot;regression&quot;</span><span class="p">)</span>

<span class="n">housing_fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">workflow</span><span class="p">()</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">add_recipe</span><span class="p">(</span><span class="n">housing_recipe</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">add_model</span><span class="p">(</span><span class="n">housing_spec</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">fit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">housing_train</span><span class="p">)</span>

<span class="n">housing_summary</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">housing_fit</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">predict</span><span class="p">(</span><span class="n">housing_test</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">bind_cols</span><span class="p">(</span><span class="n">housing_test</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">metrics</span><span class="p">(</span><span class="n">truth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">estimate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.pred</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">.metric</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&#39;rmse&#39;</span><span class="p">)</span>

<span class="n">housing_summary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 3</caption>
<thead>
	<tr><th scope=col>.metric</th><th scope=col>.estimator</th><th scope=col>.estimate</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>rmse</td><td>standard</td><td>83214.71</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predicted values on our test data</span>

<span class="n">housing_preds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">housing_fit</span><span class="p">,</span><span class="w"> </span><span class="n">housing_test</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">bind_cols</span><span class="p">(</span><span class="n">housing_test</span><span class="p">)</span>

<span class="c1"># Plot the fitted regression line</span>

<span class="n">plot_final</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">housing</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqft</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_line</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">housing_preds</span><span class="p">,</span>
<span class="w">            </span><span class="n">mapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqft</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.pred</span><span class="p">),</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;steelblue&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;House size (square feet)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Price (USD)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">dollar_format</span><span class="p">())</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&quot;K = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">kmin</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span>

<span class="n">plot_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/c6ba7b74d7249888dbf545267b0d5d8662cc0f0eec380a2ed3becb1df1252eef.png"><img alt="../_images/c6ba7b74d7249888dbf545267b0d5d8662cc0f0eec380a2ed3becb1df1252eef.png" src="../_images/c6ba7b74d7249888dbf545267b0d5d8662cc0f0eec380a2ed3becb1df1252eef.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<section id="final-model-from-k-nn-regression">
<h4>Final model from k-nn regression<a class="headerlink" href="#final-model-from-k-nn-regression" title="Link to this heading">#</a></h4>
<p>For this model, RMSPE is 83,214.71. How can we interpret this?</p>
<blockquote>
<div><p>Roughly, prices tend to be +/- $83,214.71 off that line (not that great).</p>
</div></blockquote>
</section>
<section id="discussion-which-of-the-following-is-overfitting-underfitting">
<h4>Discussion: Which of the following is overfitting? Underfitting?<a class="headerlink" href="#discussion-which-of-the-following-is-overfitting-underfitting" title="Link to this heading">#</a></h4>
<a class="reference internal image-reference" href="https://datasciencebook.ca/_main_files/figure-html/07-howK-1.png"><img alt="https://datasciencebook.ca/_main_files/figure-html/07-howK-1.png" src="https://datasciencebook.ca/_main_files/figure-html/07-howK-1.png" style="width: 600px;" /></a>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./notes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="day2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Day 2 - Girls in Data Science</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Day 3 - Girls in Data Science</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#day-3-learning-objectives">Day 3 Learning Objectives</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#classification">1. Classification</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-kind-of-data-analysis-question-is-this">What kind of data analysis question is this?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-and-test-sets">1.2 Training and Test Sets</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#golden-rule-of-machine-learning-statistics">Golden Rule of Machine Learning / Statistics:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nearest-neighbours-classification">1.3 K-nearest neighbours classification</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-would-the-predicted-class-be">What would the predicted class be?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-can-go-beyond-2-predictors">We can go beyond 2 predictors!</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standardizing-data">1.4 Standardizing Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nonstandardized-data-vs-standardized-data">Nonstandardized Data vs. Standardized Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tidymodels-package-in-r">1.5 <code class="docutils literal notranslate"><span class="pre">tidymodels</span></code> package in R</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-a-recipe-to-specify-the-predictors-response-and-preprocess-the-data">1. Make a <code class="docutils literal notranslate"><span class="pre">recipe</span></code> to specify the predictors/response and preprocess the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-a-model-specification-model-spec-to-specify-the-model-and-training-algorithm">2. Build a model specification (<code class="docutils literal notranslate"><span class="pre">model_spec</span></code>) to specify the model and training algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#put-them-together-in-a-workflow-and-then-fit-it">3. Put them together in a workflow and then <code class="docutils literal notranslate"><span class="pre">fit</span></code> it</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-a-new-class-label-using-predict">4. Predict a new class label using <code class="docutils literal notranslate"><span class="pre">predict</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-measure-classifier-performance">1.6 How to measure classifier performance?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy">Accuracy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precision-and-recall">Precision and Recall</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-question">In-class Question</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-k-or-tuning-the-model">1.7 Choosing K (or, “tuning’’ the model)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation">Cross-Validation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#underfitting-overfitting">Underfitting &amp; Overfitting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Underfitting &amp; Overfitting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Underfitting &amp; Overfitting</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-performance-metrics">1.8 Compute performance metrics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-big-picture">The Big Picture</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question">Question</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#activity">Activity</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#regression">2. Regression</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nearest-neighbours-regression">2.1 K nearest neighbours regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-evaluation-and-tuning">2.2 Model Evaluation and Tuning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#is-our-model-any-good">Is our model any good?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#final-model-from-k-nn-regression">Final model from k-nn regression</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion-which-of-the-following-is-overfitting-underfitting">Discussion: Which of the following is overfitting? Underfitting?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Katie Burak
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>